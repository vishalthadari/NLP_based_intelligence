YUI.add("flickr-products-subscriptions-orders-create-creator",function(r,s){"use strict";var t={1:"Flickr Pro",2:"Flickr Pro",3:"Flickr Pro",4:"Ad Free",6:"Ad Free",7:"Flickr Pro",8:"Flickr Pro"},a={1:"3 months",2:"1 year",3:"2 years",4:"1 year",6:"1 month",7:"1 month",8:"1 year"};r.namespace("ModelCreators")["flickr-products-subscriptions-orders-create"]={run:function(t,a){var e=this;return r.Promise.all([a.callAPI("flickr.subscriptions.braintree.initiateSubscription",this._processParams(t)),a.getModelRegistry("flickr-products-orders-models")]).then(function(r){return e._processResponse(r,t)},r.FetcherErrorLogger(s))},_processParams:function(r){var s={};return r=r||{},s.plan_type=r.planType,s.cache_bust=Date.now(),s},_processResponse:function(r,s){var e,o=r[0].subscription,n=r[1];return o?e=n.exists(o.subscriptionId)?n.get(o.orderId):n.add({id:o.subscriptionId||null,productName:o.planData.productClassId&&s.planType?t[s.planType]+" "+a[s.planType]:o.planData.name,subscriptionDuration:o.planData.length||0,orderId:o.subscriptionId||null,costTotal:parseFloat(o.planData.price)||0,costProducts:parseFloat(o.planData.costProducts)||0,costShipping:parseFloat(o.planData.costShipping)||0,costTax:o.planData.costTax||0,statusPrint:o.planData.statusPrint||null,statusPayment:o.planData.statusPayment||null,orderType:"subscription"}):console.warn("flickr-products-subscriptions-orders-create-creator: No API response?"),e}}},"@VERSION@",{requires:["flickr-promise","flickr-products-orders-models"],optional:[]});YUI.add("flickr-products-books-editPage-updater",function(o,e){"use strict";o.namespace("ModelUpdaters")["flickr-products-books-editPage"]={run:function(r,t){var d={};return d.page_id=r.pageId,d.book_id=r.bookId,r.templateId&&(d.template_id=r.templateId),r.backgroundColor&&(d.background_color=r.backgroundColor),t.callAPI("flickr.products.books.editPage",d).then(null,o.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-products-books-getPage-fetcher",function(e,o){"use strict";e.namespace("ModelFetchers")["flickr-products-books-getPage"]={run:function(t,r){var s=this;return e.Promise.all([r.callAPI("flickr.products.books.getPage",this._processParams(t)),r.getModelRegistry("page-models")]).then(function(e){return s._processResponse(e,t)},e.FetcherErrorLogger(o))},_processParams:function(o){var t={extras:e.APIHelper.request.getRebootPhotoExtras(),book_id:o.bookId,page_id:o.id};return o.page=o.page||1,o.perPage=o.perPage||100,t},_processResponse:function(e,o){var t=e[0],r=e[1],s={id:o.id,photo:[]},a=[];r.exists(o.id)&&(!!(a=r.getValue(o.id,"photoList").getList()).hasMinBoundary&&a.hasMinBoundary(),!!a.hasMaxBoundary&&a.hasMaxBoundary()),s.pageNumber=t.pageNumber,s.template=parseInt(t.template,10),s.countPhotos=t.countPhotos,s.photo=t.photo,s.backgroundColor=t.backgroundColor,r.exists(o.id)?r.setValue(o.id,"photoList",s.photoList):r.add(s)}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models"]});YUI.add("flickr-products-books-setPagePhoto-updater",function(o,e){"use strict";o.namespace("ModelUpdaters")["flickr-products-books-setPagePhoto"]={run:function(t,r){var s={};return s.page_id=t.pageId,s.book_id=t.bookId,s.position=t.position,s.photo_id=t.photoId,s.crop_x=Math.round(Math.abs(100*t.cropX)),s.crop_y=Math.round(Math.abs(100*t.cropY)),s.crop_w=Math.round(Math.abs(100*t.cropW)),s.crop_h=Math.round(Math.abs(100*t.cropH)),s.extras=o.APIHelper.request.getRebootPhotoExtras(),o.Promise.all([r.callAPI("flickr.products.books.setPagePhoto",s),r.getModelRegistry("page-models"),r.getModelRegistry("book-page-photo-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models")]).then(function(e){return(function(e,t){var r,s,d=e[0],p=e[1],a=e[2],i=e[3],n=e[4],l=e[5],c=d.page,g=[];c&&(c.photo&&o.Array(c.photo).forEach(function(e){var r,d,p,h;r={id:c.id+"_"+e.position,bookId:t.bookId,position:e.position,cropX:e.cropX/100,cropY:e.cropY/100,cropW:e.cropW/100,cropH:e.cropH/100,invalidForPrintReason:e.invalidForPrintReason,isInvalidForPrint:e.isInvalidForPrint},p=(d=o.APIHelper.response.parsePhoto(e)).owner,h=d.engagement,s=p.id,n.exists(s)?(delete p.id,n.setValues(s,p)):n.add(p),d.owner=n.proxy(s),s=h.id,l.exists(s)?(delete h.id,l.setValues(s,h)):l.add(h),d.engagement=l.proxy(s),s=d.id,i.exists(s)?(delete d.id,i.setValues(s,d)):i.add(d),r.photo=i.proxy(s),s=r.id,a.exists(s)?(delete r.id,a.setValues(s,r)):a.add(r),g.push(a.proxy(s))}),(r=o.APIHelper.response.parsePage(c)).pagePhotos=g,s=r.id,p.exists(s)?(delete r.id,p.setValues(s,r)):p.add(r))})(e,t)},o.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise"],optional:["page-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});YUI.add("book-page-photo-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(t){},create:function(e){return t.ModelUpdaters["flickr-products-books-setPagePhoto"].run({create:!0,pageId:e.pageId,bookId:e.bookId,position:1,photoId:e.photoId,template:2,cropX:0,cropY:0,cropW:0,cropH:0},this.appContext)},update:function(e,r){return t.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(e,"bookId")},this.appContext)}},attributes:{bookId:{getter:function(t){return parseInt(t,10)},validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},photo:{isModel:!0},cropW:{setter:function(t){return Math.abs(t)||0},getter:function(t){return parseFloat(t,10)||0},defaultFn:function(){return 0},defaultValue:0},cropH:{setter:function(t){return Math.abs(t)||0},getter:function(t){return parseFloat(t,10)||0},defaultFn:function(){return 0},defaultValue:0},cropX:{setter:function(t){return Math.abs(t)||0},getter:function(t){return parseFloat(t,10)||0},defaultFn:function(){return 0},defaultValue:0},cropY:{setter:function(t){return Math.abs(t)||0},getter:function(t){return parseFloat(t,10)||0},defaultFn:function(){return 0},defaultValue:0},position:{defaultFn:function(){return 1},getter:function(t){return parseInt(t,10)||1},defaultValue:1},isLowQuality:{defaultFn:function(){return 0}},invalidForPrintReason:{},isInvalidForPrint:{defaultFn:function(){return 0}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-setPagePhoto-updater"]});YUI.add("flickr-products-books-addPage-creator",function(o,e){"use strict";o.namespace("ModelCreators")["flickr-products-books-addPage"]={run:function(r,s){var t=this;return o.Promise.all([s.callAPI("flickr.products.books.addPage",this._processParams(r)),s.getModelRegistry("page-models"),s.getModelRegistry("book-page-photo-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("book-models"),s.getModelRegistry("photo-engagement-models")]).then(function(o){return t._processResponse(o,r,s)},o.FetcherErrorLogger(e))},_processParams:function(e){var r={book_id:e.bookId};return e.photoIds&&(r.photo_ids=e.photoIds.join(","),r.extras=o.APIHelper.request.getRebootPhotoExtras()),o.Lang.isNumber(e.templateId)&&(r.template_id=e.templateId),e.backgroundColor&&(r.background_color=e.backgroundColor),r},_processResponse:function(e,r,s){var t,d,a,i=e[0],p=e[1],n=e[2],l=e[3],g=e[4],c=e[5],u=e[6],m=[],h=i.page;return h.photo&&o.Array(h.photo).forEach(function(e){var s,t,a,i;s={id:h.id+"_"+e.position,bookId:r.bookId,position:e.position,cropX:e.cropX/100,cropY:e.cropY/100,cropW:e.cropW/100,cropH:e.cropH/100,invalidForPrintReason:e.invalidForPrintReason,isInvalidForPrint:e.isInvalidForPrint},a=(t=o.APIHelper.response.parsePhoto(e)).owner,i=t.engagement,d=a.id,g.exists(d)?(delete a.id,g.setValues(d,a)):g.add(a),t.owner=g.proxy(d),d=i.id,u.exists(d)?(delete i.id,u.setValues(d,i)):u.add(i),t.engagement=u.proxy(d),d=t.id,l.exists(d)?(delete t.id,l.setValues(d,t)):l.add(t),s.photo=l.proxy(d),d=s.id,n.exists(d)?(delete s.id,n.setValues(d,s)):n.add(s),m.push(n.proxy(d))}),a=o.APIHelper.response.parsePage(h),a.pagePhotos=m,a.bookId=r.bookId,d=a.id,p.exists(d)?(delete a.id,p.setValues(d,a),t=p.proxy(d)):t=p.add(a),c.proxy(r.bookId).getValue("pages").appendToList(t),t}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});YUI.add("flickr-products-books-removePage-deletor",function(e,o){"use strict";e.namespace("ModelDeletors")["flickr-products-books-removePage"]={run:function(r,s,i){var c={},t=this;return c.page_id=r,c.book_id=s,e.Promise.all([i.getModelRegistry("book-models"),i.callAPI("flickr.products.books.removePage",c)]).then(function(e){return t._processResponse(e)},e.FetcherErrorLogger(o))},_processResponse:function(e,o){var r,s=e[1],i=e[0],c=s.book;c&&(r={id:c.id,price:c.price},i.exists(r.id)&&i.setValues(r.id,{price:r.price}))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("page-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books-getPage"].run(t,this.appContext)},update:function(t,r){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-addPage"].run(t,this.appContext)},delete:function(t){return e.ModelDeletors["flickr-products-books-removePage"].run(t,this.getValue(t,"bookId"),this.appContext)}},forceUpdate:function(t){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},attributes:{bookId:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},backgroundColor:{defaultValue:"255,255,255"},pageNumber:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},template:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotos:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},pagePhotos:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-products-books-editPage-updater","flickr-products-books-getPage-fetcher","flickr-products-books-addPage-creator","flickr-products-books-removePage-deletor","flickr-model-registry","flickr-promise"]});YUI.add("flickr-products-books-fetcher",function(e,o){"use strict";e.namespace("ModelFetchers")["flickr-products-books"]={run:function(t,s){var r=this;return new e.FlickrPromise({response:s.callAPI("flickr.products.books.getBook",this._processParams(t)),pageModelRegistry:s.getModelRegistry("page-models"),bookModelRegistry:s.getModelRegistry("book-models"),pagePhotoModelRegistry:s.getModelRegistry("book-page-photo-models"),photoModelRegistry:s.getModelRegistry("photo-models"),personRegistry:s.getModelRegistry("person-models"),photoEngagementRegistry:s.getModelRegistry("photo-engagement-models"),photoStatsRegistry:s.getModelRegistry("photo-stats-models")}).then(function(e){return r._processResponse(e,t)},e.FetcherErrorLogger(o))},_processResponse:function(o,t){var s;return s={pageModelRegistry:o.pageModelRegistry,bookModelRegistry:o.bookModelRegistry,pagePhotoModelRegistry:o.pagePhotoModelRegistry,photoModelRegistry:o.photoModelRegistry,personRegistry:o.personRegistry,photoEngagementRegistry:o.photoEngagementRegistry,photoStatsRegistry:o.photoStatsRegistry},e.ProductsAPIHelper.parseBook(o.response.book,s)},_processParams:function(o){return o.page=o.page||1,o.perPage=o.perPage||100,{book_id:o.id,extras:e.APIHelper.request.getRebootPhotoExtras()}}}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});YUI.add("flickr-products-books-updateBook-updater",function(t,e){"use strict";t.namespace("ModelUpdaters")["flickr-products-books-updateBook"]={run:function(t,e){var o=t.bookId;return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(o,e)},serialize:function(e,o){return t.Promise.all([o.getModel("book-models",e),o.getModelRegistry("page-models")]).then(function(t){var e,i,a={},n=t[0],r=t[1];return e={id:""+n.id,owner:o.getViewer().nsid,title:n.getValue("title")},i=n.getValue("pageOrder"),e.count_pages=i.length-1,i.forEach(function(t,e){var o,i,n={};o={id:(i=r.proxy(t)).id,page_number:i.getValue("pageNumber")+"",count_photos:i.getValue("countPhotos")+"",template:i.getValue("template")+"",background_color:i.getValue("backgroundColor")},i.getValue("pagePhotos").getList().forEach(function(t,e){var o;t.getValue("photo")&&(o={id:t.getValue("photo").id,position:e+1+"",crop_x:100*t.getValue("cropX")+"",crop_y:100*t.getValue("cropY")+"",crop_w:100*t.getValue("cropW")+"",crop_h:100*t.getValue("cropH")+"",low_quality:t.getValue("isLowQuality"),is_invalid_for_print:t.getValue("isInvalidForPrint")},n[e+1]=o)}),o.photos=n,a[e]=o}),e.pages=a,e})},callAPI:function(o,i,a){var n=this;return this.serialize(o,i).then(function(a){return i.callAPI("flickr.products.books.updateBook",{book:JSON.stringify(a)}).then(function(e){if(e[0]&&e[0].badPhotos)t.fire("bookUpdater:failure",{badPhotos:e[0].badPhotos});else if(n.pendingUpdate)return n.pendingUpdate=!1,n.startNextUpdate(o,i)},function(t){throw n.pendingUpdate&&(n.pendingUpdate=!1),t}).then(null,t.FetcherErrorLogger(e))})},clearUpdateInFlight:function(){return this.updateInFlight=null,!0},startUpdate:function(t,e){return this.updateInFlight=this.callAPI(t,e).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight},startNextUpdate:function(t,e){return this.pendingUpdate=null,this.startUpdate(t,e)}}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models"]});YUI.add("api-products-books-helper",function(e){e.APIProductsBooksHelper={processDefaultResponse:function(o,s,r,p){var t,a,i=o.book,d=[];i&&(a={id:i.id,owner:i.owner,title:i.title,coverPhotoId:i.coverPhotoId},i.page&&e.Array(i.page).forEach(function(o){s.exists(o.id)?t=e.APIHelper.response.parsePage(o):s.add(e.APIHelper.response.parsePage(o)),d.push(s.proxy(o.id))}),a.pages=d,r.exists(a.id)?r.setValues(a.id,{title:a.title,pages:a.pages,coverPhotoId:a.coverPhotoId}):r.add(a))}}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});YUI.add("flickr-products-books-editBook-updater",function(o,e){"use strict";o.namespace("ModelUpdaters")["flickr-products-books-editBook"]={run:function(r,t){var i={};return i.book_id=r.bookId,i.title=r.title,o.Promise.all([t.callAPI("flickr.products.books.editBook",i),t.getModelRegistry("book-models")]).then(null,o.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});YUI.add("flickr-products-books-creator",function(e,o){"use strict";e.namespace("ModelCreators")["flickr-products-books-creator"]={run:function(t,s){var r=this;return new e.FlickrPromise({response:s.callAPI("flickr.products.books.create",this._processParams(t)),pageModelRegistry:s.getModelRegistry("page-models"),bookModelRegistry:s.getModelRegistry("book-models"),pagePhotoModelRegistry:s.getModelRegistry("book-page-photo-models"),photoModelRegistry:s.getModelRegistry("photo-models"),personRegistry:s.getModelRegistry("person-models"),photoEngagementRegistry:s.getModelRegistry("photo-engagement-models"),photoStatsRegistry:s.getModelRegistry("photo-stats-models")}).then(function(e){return r._processResponse(e,t)},e.FetcherErrorLogger(o))},_processParams:function(o){var t={};return o=o||{},t=o,t.cacheBust=Date.now(),t.extras=e.APIHelper.request.getRebootPhotoExtras(),t},_processResponse:function(o,t){var s;return s={pageModelRegistry:o.pageModelRegistry,bookModelRegistry:o.bookModelRegistry,pagePhotoModelRegistry:o.pagePhotoModelRegistry,photoModelRegistry:o.photoModelRegistry,personRegistry:o.personRegistry,photoEngagementRegistry:o.photoEngagementRegistry,photoStatsRegistry:o.photoStatsRegistry},e.ProductsAPIHelper.parseBook(o.response.book,s)}}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});YUI.add("book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books"].run(t,this.appContext)},update:function(t,r){return"title"in r?e.ModelUpdaters["flickr-products-books-editBook"].run({bookId:t,title:r.title.newVal},this.appContext):e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:t},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-creator"].run(t,this.appContext)}},movePage:function(e,t,r,o){var s,i,a,c;return s=this.getValue(e,"pageOrder"),i=s.length,t<i&&r<i&&(c=o?s.splice(t,2):s.splice(t,1)[0],a=[r,0].concat(c),Array.prototype.splice.apply(s,a)),this.setValue(e,"pageOrder",s),s},addPage:function(e,t,r){var o,s;return o=this.getValue(e,"pageOrder"),s=o.length,r<=s&&o.splice(r+1,0,t),this.setValue(e,"pageOrder",o),o},removePage:function(e,t){var r,o,s;return r=this.getValue(e,"pageOrder"),s=r.length,(o=r.indexOf(t))<s&&(r.splice(o,1),this.setValue(e,"pageOrder",r)),r},attributes:{title:{},owner:{},pageOrder:{},coverPage:{isModel:!0},totalPhotos:{},price:{},lastPageViewed:{},created:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater","flickr-products-books-creator"]});YUI.add("flickr-products-subscriptions-getSubscriptionDetails-fetcher",function(t,r){"use strict";var s,o;s={1:"Flickr Pro",2:"Flickr Pro",3:"Flickr Pro",4:"Ad Free",6:"Ad Free",7:"Flickr Pro",8:"Flickr Pro"},o={1:"3 months",2:"1 year",3:"2 years",4:"1 year",6:"1 month",7:"1 month",8:"1 year"},t.namespace("ModelFetchers")["flickr-products-subscriptions-getSubscriptionDetails"]={run:function(s,o){var e=this;return t.Promise.all([o.callAPI("flickr.subscriptions.braintree.getSubscriptionDetails",this._processParams(s)),o.getModelRegistry("flickr-products-orders-models"),o.getModelRegistry("flickr-subscriptions-coupons-models"),o.getModelRegistry("flickr-products-discounts-models")]).then(function(t){return e._processResponse(t,s)},t.FetcherErrorLogger(r))},_processResponse:function(r,e){var i,a=r[0].subscriptionData,n=r[1],c=r[2],d=r[3];return a?(i=n.exists(a.orderId)?n.get(a.orderId):n.add({id:a.data.id||null,productName:s[a.data.type]+" "+o[a.data.type],prettyName:a.planInfo.prettyName,prettyNameDuration:a.planInfo.prettyNameDuration,subscriptionDuration:a.planInfo.length||0,orderId:a.data.id||null,costTotal:parseFloat(a.planInfo.price)||0,costProducts:parseFloat(a.planInfo.costProducts)||0,costShipping:0,costTax:a.planInfo.costTax||0,statusOrder:a.data.status||0,statusPayment:a.statusPayment||null,paymentMethodId:a.data.paymentMethodId||null,orderType:"subscription"}),a.data.discounts&&a.data.discounts[0]&&a.data.discounts[0].discount&&i.setValue("coupon",t.ProductsAPIHelper.parseSubscriptionCoupon({subscriptionId:a.data.id,discount:a.data.discounts[0].discount,stat:r[0].stat},{couponRegistry:c,discountRegistry:d}))):console.warn("flickr-products-subscriptions-orders-create-creator: No API response?"),i},_processParams:function(t){return{subscription_id:t.orderId||t.id}}}},"@VERSION@",{requires:["flickr-promise","products-api-helper"],optional:["book-models"]});YUI.add("flickr-products-shippingType-updater",function(r,e){"use strict";r.namespace("ModelUpdaters")["flickr-products-shippingType-updater"]={run:function(p,i){var o={order_id:p.orderId,shipping_type:p.shippingType};return p.countryCode&&(o.country_code=p.countryCode),i.callAPI("flickr.products.orders.setShippingType",o).then(null,r.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-products-orders-getOrder-fetcher",function(r,e){"use strict";r.namespace("ModelFetchers")["flickr-products-orders-getOrder"]={run:function(s,o){var t=this;return new r.FlickrPromise({response:o.callAPI("flickr.products.orders.getOrder",this._processParams(s)),orderRegistry:o.getModelRegistry("flickr-products-orders-models"),couponRegistry:o.getModelRegistry("flickr-products-coupons-models"),discountRegistry:o.getModelRegistry("flickr-products-discounts-models"),itemRegistry:o.getModelRegistry("products-order-item-models"),itemPriceRegistry:o.getModelRegistry("products-order-item-price-models")}).then(function(r){return t._processResponse(r,s,o)},r.FetcherErrorLogger(e))},_processResponse:function(e,s,o){var t,i,d,c,u,p,n;return n=e.response,t=e.orderRegistry,i=e.couponRegistry,d=e.discountRegistry,c=e.itemRegistry,u=e.itemPriceRegistry,p={orderRegistry:t,orderItemRegistry:c,itemPriceRegistry:u,couponRegistry:i,discountRegistry:d},r.ProductsAPIHelper.parseOrder(n.order,p)},_processParams:function(r){var e={};return e.order_id=r.orderId||r.id,e}}},"@VERSION@",{requires:["flickr-promise","products-api-helper"],optional:["flickr-products-orders-models","flickr-products-coupons-models","flickr-products-discounts-models","products-order-item-models","products-order-item-price-models"]});